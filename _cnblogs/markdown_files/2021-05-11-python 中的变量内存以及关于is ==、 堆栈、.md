---
layout: post
title:  "python 中的变量内存以及关于is ==、 堆栈、"
date:   2021-05-11 11:57:00
categories: 
tags:  zengzzzzz-blog
---

* content
{:toc}

在工作学习中会碰到一些python中变量与内存层面的问题理解，虽然是在不断的解决，但是并没有做过这方面的总结。  
变量：用来标识(identify)一块内存区域。为了方便表示内存，我们操作变量实质上是在操作变量指向的那块内存单元。编译器负责分配。我们可以使用Python内建函数id()来获取变量的地址  
变量名：是一个标识符(dientify)，用来代之一块内存空间，使用这个变量名，我们可以很方便的操作这块内存区域。  
内存：内存是我们电脑硬件，用来存放数据，形象的理解就是内存有一个一个的小格子组成，每个格子的大小是一个字节，每个格子可以存放一个字节大小的数据。我们如何才能知道，数据存放在哪些格子中，那就得靠地址，地址类似于楼房的门牌号，是内存的标识符。  
id(object)：函数是返回对象object在其生命周期内位于内存中的地址，id函数的参数类型是一个对象。  
is：&nbsp;比较的是两个对象的id值是否相等，也就是比较俩对象是否为同一个实例对象，是否指向同一个内存地址。  
==：&nbsp;比较的是两个对象的内容是否相等，默认会调用对象的__eq__()方法。  
对在【-5，256】之外的数字is不等时的解释：出于对性能的考虑，Python内部做了很多的优化工作，对于整数对象，Python把一些频繁使用的整数对象缓存起来，保存到一个叫small_ints的链表中，在Python的整个生命周期内，任何需要引用这些整数对象的地方，都不再重新创建新的对象，而是直接引用缓存中的对象。Python把这些可能频繁使用的整数对象规定在范围[-5, 256]之间的小对象放在small_ints中，但凡是需要用些小整数时，就从这里面取，不再去临时创建新的对象。因为257不再小整数范围内，因此尽管a和b的值是一样，但是他们在Python内部却是以两个独立的对象存在。  
不同代码块中的257不等，相同代码块则相等的解释：Python程序由代码块构成，代码块作为程序的一个最小基本单位来执行。一个模块文件、一个函数体、一个类、交互式命令中的单行代码都叫做一个代码块。c = 257作为一个代码块，函数foo作为另外一个代码块。Python内部为了将性能进一步的提高，凡是在一个代码块中创建的整数对象，如果存在一个值与其相同的对象于该代码块中了，那么就直接引用，否则创建一个新的对象出来。Python出于对性能的考虑，但凡是不可变对象，在同一个代码块中的对象，只有是值相同的对象，就不会重复创建，而是直接引用已经存在的对象。因此，不仅是整数对象，还有字符串对象也遵循同样的原则。所以 a is b就理所当然的返回True了，而c和a不在同一个代码块中，因此在Python内部创建了两个值都是257的对象。  
1、小整数对象[-5,256]是全局解释器范围内被重复使用，永远不会被GC回收。  
2、同一个代码块中的不可变对象，只要值是相等的就不会重复创建新的对象。  
python中的堆栈含义：  
内存空间在逻辑上分为三部分：代码区、静态数据区和动态数据区，动态数据区又分为栈区和堆区。  
代码区：存储方法体的二进制代码。高级调度（作业调度）、中级调度（内存调度）、低级调度（进程调度）控制代码区执行代码的切换。  
静态数据区：存储全局变量、静态变量、常量，常量包括final修饰的常量和String常量。系统自动分配和回收。  
栈区：存储运行方法的形参、局部变量、返回值。由系统自动分配和回收。  
堆区：new一个对象的引用或地址存储在堆区，指向该对象存储在堆区中的真实数据。  
简而言之一句话：栈放变量，堆放对象  
&nbsp;
